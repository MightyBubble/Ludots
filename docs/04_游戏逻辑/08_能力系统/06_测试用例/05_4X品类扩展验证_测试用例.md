---
文档类型: 测试用例
创建日期: 2026-02-09
最后更新: 2026-02-09
维护人: Claude
文档版本: v1.0
适用范围: GAS - 4X品类扩展验证 (FourXDemoMod 扩展)
状态: 已实现
---

# 4X 品类扩展验证测试用例

## 1 测试总览

在 GPT 原有 BuildOutpost/Colonize/Block 基础上新增 4 个场景，补充 4 阵营非对称关系、TechResearch、DiplomacyPact、TradeRoute(Stack)、Manual 时钟。

## 2 场景列表

### X3: 科技研究 (TechResearch + GrantedTags + Duration)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | Governor 激活 TechResearch (4104) | Buff(After, 300 ticks): TechProgress+1, GrantedTags=[Status.Researching] |
| 2 | 300 ticks 后效果过期 | TechProgress 恢复, Status.Researching 移除 |
| 3 | 后续激活 TechComplete | Buff(Infinite): GrantedTags=[Tech.Agriculture], FoodProduction+10 |

### X4: 外交协约 (DiplomacyPact + 4 阵营非对称关系)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 设置 4 阵营关系 | Empire(1)↔Federation(2): Friendly; Empire↔Horde(3): Hostile; Horde↔Nomads(4): Hostile(单向) |
| 2 | 验证非对称 | Horde→Nomads=Hostile, Nomads→Horde=Neutral |
| 3 | 施放 DiplomacyPact (4105) | GrantedTags=[Status.Allied], Infinite |
| 4 | 验证 Status.Allied | 目标实体获得 Allied 标签 |

### X5: 贸易路线 (TradeRoute + Stack KeepDuration)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 激活 TradeRoute (4106) | Buff(After, 600 ticks): Gold+3, Stack(KeepDuration, limit=5) |
| 2 | 再次激活 | Stack=2, duration 不变 (KeepDuration), Gold +6 total |
| 3 | 叠加到 5 层 | Stack=5, Gold +15 total |
| 4 | 第 6 次激活 | RejectNew, Stack 保持 5 |

### X6: Manual 时钟 (回合制科技推进)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 加载 4X mod (clock.json mode=Manual, stepEvery=10) | GasStepMode=Manual |
| 2 | 固定帧推进不产生 step | Duration 效果不 tick |
| 3 | RequestStep(1) | TechResearch 的 Duration 推进 |
| 4 | 验证确定性 | 相同操作序列产生相同结果 |
