---
文档类型: 裁决条款
创建日期: 2026-02-05
最后更新: 2026-02-05
维护人: X28技术团队
文档版本: v0.1
适用范围: 基础服务 - 物理系统 - 宽相与查询预算
状态: 草案
依赖文档:
  - docs/00_文档总览/规范/14_裁决条款.md
  - docs/03_基础服务/06_空间服务/02_接口规范/01_空间查询接口_接口规范.md
---

# 宽相与查询预算 裁决条款

# 1 裁决背景

物理系统作为“候选生成/几何约束”的后端能力，经常被上层系统（导航/避障/技能）高频调用。若查询不受控，会导致：

- 结果顺序不稳定（不可回放）
- 查询爆量导致帧耗不可控
- 静默丢弃导致“偶现穿模/挤压/战术差异”

# 2 裁决结论

## 2.1 必须遵守的规则

1. 必须可预算：所有“候选集合”查询必须提供固定容量输出形态（Span/Buffer），并能报告 dropped。  
2. 必须稳定序：若返回集合需要排序/去重，tie-break 必须固化且可回放。  
3. 禁止静默 fallback：超容量/缺失依赖/非法输入必须可观测并显式退化或 fail-fast。  

## 2.2 推荐实践

- 把物理查询作为空间服务的 backend 使用时，优先复用空间服务的稳定序与固定容量契约，避免重复造口径。  

# 3 代码入口（文件路径）

- `src/Core/Physics/PhysicsWorld.cs`
- `src/Core/Spatial/PhysicsWorldSpatialBackend.cs`
