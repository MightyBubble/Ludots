---
文档类型: 总览入口
创建日期: 2026-02-05
最后更新: 2026-02-05
维护人: X28技术团队
文档版本: v0.2
适用范围: 基础服务 - 空间服务 - 目录入口
状态: 草案
---

# 空间服务 总览

# 1 本目录定位

## 1.1 读者与范围

读者：

- 引擎/服务开发：需要扩展空间索引、增加 backend、定位性能瓶颈
- 玩法/AI/表现开发：需要调用空间查询或依赖可见性/分帧更新的口径
- 测试/验收：需要对 64km 大世界的约束做可判定验证

范围：

- 空间查询（Query）：AABB/Radius 候选查询，固定容量输出，dropped 可观测
- 空间索引（Index）：增量索引与分桶索引的策略裁决
- AOI/Chunk/Streaming：LoadedChunks 单一真源与 enter/exit 口径
- 可见性与分帧更新：time-slice/tick-rate 的关键裁决条款

## 1.2 本目录边界

- 不定义业务语义（阵营/标签/技能条件等必须通过 token/ID 注入）
- 不绑定具体渲染/物理/导航实现；仅定义运行时契约与裁决条款
- 不承诺向后兼容与静默 fallback（默认 fail-fast）

## 1.3 推荐阅读顺序

1. 架构设计：先建立职责边界与主流程（见 `01_架构设计/01_空间服务_架构设计.md`）。
2. 接口规范：再确定 Query 的可调用契约（见 `02_接口规范/01_空间查询接口_接口规范.md`）。
3. 裁决条款：最后对 AOI/Chunk 与可见性/time-slice 做不可回避的裁决（见 `04_裁决条款/`）。

# 2 SSOT

## 2.1 代码入口

- 空间服务核心：`src/Core/Spatial/`
- 坐标与数学结构：`src/Core/Math/`
- AOI：`src/Core/Navigation/AOI/`
- 表现侧裁剪（消费者示例）：`src/Core/Systems/CameraCullingSystem.cs`

## 2.2 口径说明

空间服务的口径真源以代码为准，原因：

- 空间服务属于运行时基础设施，任何静默兼容、隐式扩容、隐式加载都会直接破坏帧耗上限与一致性
- 以代码入口作为可审计真源，才能让对齐报告与测试用例形成闭环

## 2.3 关键约束

1. 禁止在正文中写本机绝对路径或 file:// 链接。
2. Query 输出必须固定容量 + dropped 可观测（不得隐式扩容掩盖问题）。
3. 默认 fail-fast：越界/依赖缺失不得静默 fallback。

# 3 子文档索引

## 3.1 子文档清单

本目录采用布局 B（按类型分组），所有新增文档必须放入对应类型目录。

- `01_架构设计/01_空间服务_架构设计.md`
- `01_架构设计/02_空间索引策略_架构设计.md`
- `02_接口规范/01_空间查询接口_接口规范.md`
- `04_裁决条款/01_AOI与Chunk_裁决条款.md`
- `04_裁决条款/02_可见性与分帧更新_裁决条款.md`
- `05_对齐报告/01_空间服务_对齐报告.md`
- `06_测试用例/01_64km_空间服务_测试用例.md`
- `07_外部参考/01_插件对比_外部参考.md`

## 3.2 文档类型与阅读路径

- 架构设计：定义整体边界、主流程、数据模型与落地方式。
- 接口规范：定义 ISpatialQueryService/Backend 等接口契约与使用约束。
- 裁决条款：给出不可回避的规则（LoadedChunks 真源、time-slice、失败策略等）。
- 对齐报告：记录 Design vs Code 差异表与行动项（含证据路径）。
- 测试用例：提供可复现步骤与可观察信号，支持验收/回归。
- 外部参考：默认放在本目录 `07_外部参考/`，跨子系统主题可放在 `docs/07_附录与扩展/external/`，需要落地的结论回填到本目录裁决条款与接口规范。

